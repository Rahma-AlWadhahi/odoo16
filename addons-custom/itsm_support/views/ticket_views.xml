<odoo>

    <record id="itsm_ticket_action" model="ir.actions.act_window">
        <field name="name">Tickets</field>
        <field name="res_model">itsm.ticket</field>
        <field name="view_mode">kanban,tree,form</field>
    </record>

    <!-- Kanban -->
    <record id="itsm_ticket_kanban" model="ir.ui.view">
        <field name="name">itsm.ticket.kanban</field>
        <field name="model">itsm.ticket</field>
        <field name="arch" type="xml">

            <kanban
                default_group_by="stage_id"
                class="o_kanban_small_column"
                default_order="priority desc, id desc">

                <!-- fields -->
                <field name="name"/>
                <field name="subject"/>
                <field name="partner_id"/>
                <field name="user_id"/>
                <field name="priority"/>
                <field name="deadline"/>

                <templates>

                    <t t-name="kanban-box">

                        <!-- FLAT ROW STYLE -->
                        <div class="oe_kanban_global_click py-2 px-2">

                            <!-- Title -->
                            <div class="fw-semibold text-truncate">
                                <field name="subject"/>
                            </div>

                            <!-- Ticket number -->
                            <div class="text-muted small mb-1">
                                <field name="name"/>
                            </div>

                            <!-- Bottom line -->
                            <div class="d-flex justify-content-between align-items-center small">

                                <!-- Left: requester -->
                                <span class="text-muted">
                                    <i class="fa fa-user me-1"  title="Assigned To"/>
                                    <field name="partner_id"/>
                                </span>

                                <!-- Right: priority -->
                                <field name="priority" widget="priority"/>

                            </div>

                            <!-- Assignee -->
                            <div class="mt-1 small">
                                <t t-if="record.user_id.value">
                                    <field name="user_id"
                                        widget="many2one_avatar_user"/>
                                </t>
                                <t t-else="">
                                    <span class="text-muted">
                                        <i class="fa fa-user me-1" title="Assigned To"/>
                                        Unassigned
                                    </span>
                                </t>
                            </div>

                            <!-- Deadline -->
                            <div t-if="record.deadline.value"
                                class="small text-danger">
                                <i class="fa fa-clock me-1" title="Deadline"></i>
                                <field name="deadline"/>
                            </div>

                        </div>

                    </t>

                </templates>

            </kanban>

        </field>
    </record>



    <!-- Tree -->
    <record id="itsm_ticket_tree" model="ir.ui.view">
        <field name="name">itsm.ticket.tree</field>
        <field name="model">itsm.ticket</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="subject"/>
                <field name="team_id"/>
                <field name="user_id"/>
                <field name="priority"/>
                <field name="stage_id"/>
            </tree>
        </field>
    </record>

    <!-- Form -->
    <record id="itsm_ticket_form" model="ir.ui.view">
        <field name="name">itsm.ticket.form</field>
        <field name="model">itsm.ticket</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <!-- Ticket Number (highlighted) -->
                        <h2 class="text-primary fw-bold mb-1">
                            <field name="name" readonly="1"/>
                        </h2>
                        <!-- Title (read only) -->
                        <h1>
                            <field name="subject" readonly="1"/>
                        </h1>
                    </div>
                    <group col="2">
                        <group string="Ticket Details">
                            <field name="team_id"/>
                            <field name="user_id"/>
                            <field name="stage_id"/>
                            <field name="priority"/>
                            <field name="deadline"/>
                        </group>
                        <group string="Requester Information">
                            <field name="partner_id" widget="many2one_avatar"/>
                            <field name="partner_email" readonly="1"/>
                            <field name="partner_phone" readonly="1"/>
                            <field name="partner_mobile" readonly="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Description">
                            <field name="description" placeholder="Describe the issue..."/>
                        </page>
                        <page string="Attachments">
                            <field name="attachment_ids" widget="many2many_binary"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

</odoo>
